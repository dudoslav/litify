#!/bin/bash

declare -A emojis

function eloademojis() {
    while read -r -a line; do
	emojis[$line]="${line[@]:2}"
    done < "$1"
}

function ehelp() {
    echo -e '\tðŸ‘ŒLITIFYðŸ‘Œ ðŸ‘‰ substring replacer'
    echo -e '\t-h to print this help'
    echo -e '\t-e to print emojis and substitutions'
}

function eemojis() {
    echo '-------------------------'
    for emoji in "${!emojis[@]}"; do
	echo -ne "$emoji:\t"
	for name in ${emojis[$emoji]}; do
	    echo -n "$name "
	done
	echo -ne "\n"
    done
    echo '-------------------------'
}

function escript() {
    local script=''
    for emoji in "${!emojis[@]}"; do
	for name in "${emojis[$emoji]}"; do
	    script+="s/${name}/${emoji}/g; "
	done
    done
    echo "$script"
}

DEFAULT_CONFIG=/etc/lit
USER_CONFIG=~/.lit

[ -f $DEFAULT_CONFIG ] && eloademojis $DEFAULT_CONFIG
[ -f $USER_CONFIG ] && eloademojis $USER_CONFIG

while [[ $# -gt 0 ]]; do
    case $1 in
	-h|--help)
	    ehelp
	    exit
	    ;;
	-e|--emojis)
	    eemojis
	    exit
	    ;;
	-f|--file)
	    [ -f $2 ] && eloademojis $2
	    shift
	    shift
	    ;;
	*)
	    POSITIONAL+=("$1")
	    shift
	    ;;
    esac
done
set -- "${POSITIONAL[@]}"

while read line; do
    echo "$line" | sed "`escript`"
done
